<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <!-- Merge Colors -->
    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="Colors.xaml"/>
    </ResourceDictionary.MergedDictionaries>

    <!-- ====================================
    TextBlock Styles
    ==================================== -->

    <Style x:Key="TitleTextBlockStyle" TargetType="TextBlock">
        <Setter Property="FontSize" Value="{StaticResource FontSizeXXLarge}"/>
        <Setter Property="FontWeight" Value="Bold"/>
        <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
        <Setter Property="Margin" Value="0,0,0,16"/>
    </Style>

    <Style x:Key="SubtitleTextBlockStyle" TargetType="TextBlock">
        <Setter Property="FontSize" Value="{StaticResource FontSizeXLarge}"/>
        <Setter Property="FontWeight" Value="SemiBold"/>
        <Setter Property="Foreground" Value="{StaticResource PrimaryDarkBrush}"/>
        <Setter Property="Margin" Value="0,0,0,12"/>
    </Style>

    <Style x:Key="HeaderTextBlockStyle" TargetType="TextBlock">
        <Setter Property="FontSize" Value="{StaticResource FontSizeLarge}"/>
        <Setter Property="FontWeight" Value="SemiBold"/>
        <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
        <Setter Property="Margin" Value="0,0,0,8"/>
    </Style>

    <Style x:Key="BodyTextBlockStyle" TargetType="TextBlock">
        <Setter Property="FontSize" Value="{StaticResource FontSizeNormal}"/>
        <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
        <Setter Property="TextWrapping" Value="Wrap"/>
    </Style>

    <Style x:Key="CaptionTextBlockStyle" TargetType="TextBlock">
        <Setter Property="FontSize" Value="{StaticResource FontSizeSmall}"/>
        <Setter Property="Foreground" Value="{StaticResource TextTertiaryBrush}"/>
    </Style>

    <Style x:Key="ErrorTextBlockStyle" TargetType="TextBlock">
        <Setter Property="FontSize" Value="{StaticResource FontSizeSmall}"/>
        <Setter Property="Foreground" Value="{StaticResource SeverityCriticalBrush}"/>
        <Setter Property="TextWrapping" Value="Wrap"/>
        <Setter Property="Margin" Value="0,4,0,0"/>
    </Style>

    <!-- ====================================
    TextBox Styles
    ==================================== -->

    <Style x:Key="StandardTextBoxStyle" TargetType="TextBox">
        <Setter Property="FontSize" Value="{StaticResource FontSizeNormal}"/>
        <Setter Property="Padding" Value="{StaticResource SpacingMedium}"/>
        <Setter Property="BorderThickness" Value="{StaticResource BorderThicknessNormal}"/>
        <Setter Property="CornerRadius" Value="{StaticResource CornerRadiusMedium}"/>
        <Setter Property="Padding" Value="12,10" />
        <Setter Property="FontSize" Value="13" />
        <Setter Property="MinHeight" Value="40"/>
        <Setter Property="Background" Value="{ThemeResource TextControlBackground}"/>
        <Setter Property="Foreground" Value="{ThemeResource TextControlForeground}"/>
        <Setter Property="BorderBrush" Value="{ThemeResource TextControlBorderBrush}"/>
    </Style>

    <!-- ====================================
    Button Styles
    ==================================== -->

    <Style x:Key="PrimaryButtonStyle" TargetType="Button">
        <Setter Property="Background" Value="{ThemeResource ButtonPrimaryBrush}"/>
        <Setter Property="Foreground" Value="White"/>
        <Setter Property="FontSize" Value="{StaticResource FontSizeNormal}"/>
        <Setter Property="FontWeight" Value="SemiBold"/>
        <Setter Property="Padding" Value="20,12"/>
        <Setter Property="CornerRadius" Value="{StaticResource CornerRadiusMedium}"/>
        <Setter Property="MinWidth" Value="120"/>
        <Setter Property="MinHeight" Value="40"/>
        <Setter Property="HorizontalAlignment" Value="Stretch"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Grid>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="PointerOver">
                                    <VisualState.Setters>
                                        <Setter Target="RootBorder.Background" Value="{ThemeResource ButtonPrimaryHoverBrush}"/>
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Pressed">
                                    <VisualState.Setters>
                                        <Setter Target="RootBorder.Background" Value="{ThemeResource ButtonPrimaryPressedBrush}"/>
                                        <Setter Target="RootBorder.Scale" Value="0.98,0.98"/>
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Disabled">
                                    <VisualState.Setters>
                                        <Setter Target="RootBorder.Opacity" Value="0.5"/>
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Border x:Name="RootBorder"
                                Background="{TemplateBinding Background}"
                                CornerRadius="{TemplateBinding CornerRadius}"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
                        </Border>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="SuccessButtonStyle" TargetType="Button" BasedOn="{StaticResource PrimaryButtonStyle}">
        <Setter Property="Background" Value="{ThemeResource ButtonSuccessBrush}"/>
    </Style>

    <Style x:Key="SecondaryButtonStyle" TargetType="Button">
        <Setter Property="Background" Value="{ThemeResource BackgroundSecondaryBrush}"/>
        <Setter Property="Foreground" Value="{ThemeResource TextPrimaryBrush}"/>
        <Setter Property="BorderBrush" Value="{ThemeResource BorderPrimaryBrush}"/>
        <Setter Property="BorderThickness" Value="{StaticResource BorderThicknessNormal}"/>
        <Setter Property="FontSize" Value="{StaticResource FontSizeNormal}"/>
        <Setter Property="Padding" Value="20,12"/>
        <Setter Property="CornerRadius" Value="{StaticResource CornerRadiusMedium}"/>
        <Setter Property="MinWidth" Value="120"/>
        <Setter Property="MinHeight" Value="40"/>
    </Style>

    <!-- ====================================
    Dropdown Button Styles
    ==================================== -->

    <!-- Dropdown Button Style -->
    <Style x:Key="FilterDropdownButtonStyle" TargetType="Button">
        <Setter Property="Background" Value="{ThemeResource BackgroundPrimaryBrush}"/>
        <Setter Property="BorderBrush" Value="{ThemeResource BorderLightBrush}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="CornerRadius" Value="8"/>
        <Setter Property="Padding" Value="12,0"/>
        <Setter Property="Height" Value="36"/>
        <Setter Property="HorizontalAlignment" Value="Stretch"/>
        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border x:Name="RootBorder"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="{TemplateBinding CornerRadius}"
                            Padding="{TemplateBinding Padding}">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="PointerOver">
                                    <VisualState.Setters>
                                        <Setter Target="RootBorder.Background" Value="{ThemeResource BackgroundSecondaryBrush}"/>
                                        <Setter Target="RootBorder.BorderBrush" Value="{ThemeResource PrimaryMediumBrush}"/>
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Pressed">
                                    <VisualState.Setters>
                                        <Setter Target="RootBorder.Background" Value="{ThemeResource PrimaryLightBrush}"/>
                                        <Setter Target="RootBorder.BorderBrush" Value="{ThemeResource PrimaryDarkBrush}"/>
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <ContentPresenter
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Center"
                            Content="{TemplateBinding Content}"
                            ContentTemplate="{TemplateBinding ContentTemplate}"/>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Dark Flyout Presenter Style -->
    <Style x:Key="DarkFlyoutPresenterStyle" TargetType="FlyoutPresenter">
        <Setter Property="Background" Value="{ThemeResource BackgroundPrimaryBrush}"/>
        <Setter Property="BorderBrush" Value="{ThemeResource BorderLightBrush}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="CornerRadius" Value="8"/>
        <Setter Property="Padding" Value="4"/>
        <Setter Property="MinWidth" Value="200"/>
        <Setter Property="MaxHeight" Value="400"/>
        <Setter Property="ScrollViewer.HorizontalScrollMode" Value="Disabled"/>
        <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Disabled"/>
        <Setter Property="ScrollViewer.VerticalScrollMode" Value="Auto"/>
        <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
    </Style>

    <!-- Flyout ListView Style -->
    <Style x:Key="FlyoutListViewStyle" TargetType="ListView">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Padding" Value="0"/>
        <Setter Property="SelectionMode" Value="Single"/>
        <Setter Property="IsItemClickEnabled" Value="True"/>
    </Style>

    <!-- Flyout ListView Item Style -->
    <Style x:Key="FlyoutListViewItemStyle" TargetType="ListViewItem">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Padding" Value="12,10"/>
        <Setter Property="Margin" Value="4,2"/>
        <Setter Property="CornerRadius" Value="4"/>
        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ListViewItem">
                    <Border x:Name="ItemBorder"
                            Background="{TemplateBinding Background}"
                            Padding="{TemplateBinding Padding}"
                            Margin="{TemplateBinding Margin}"
                            CornerRadius="{TemplateBinding CornerRadius}">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="PointerOver">
                                    <VisualState.Setters>
                                        <Setter Target="ItemBorder.Background" Value="{ThemeResource BackgroundSecondaryBrush}"/>
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Pressed">
                                    <VisualState.Setters>
                                        <Setter Target="ItemBorder.Background" Value="{ThemeResource PrimaryLightBrush}"/>
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Selected">
                                    <VisualState.Setters>
                                        <Setter Target="ItemBorder.Background" Value="{ThemeResource PrimaryLightBrush}"/>
                                        <Setter Target="SelectedIndicator.Visibility" Value="Visible"/>
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="SelectedPointerOver">
                                    <VisualState.Setters>
                                        <Setter Target="ItemBorder.Background" Value="{ThemeResource PrimaryMediumBrush}"/>
                                        <Setter Target="SelectedIndicator.Visibility" Value="Visible"/>
                                        <Setter Target="ContentArea.Foreground" Value="White"/>
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="3"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <Border x:Name="SelectedIndicator"
                                    Grid.Column="0"
                                    Background="{ThemeResource PrimaryDarkBrush}"
                                    CornerRadius="2"
                                    Visibility="Collapsed"/>

                            <ContentPresenter x:Name="ContentArea"
                                              Grid.Column="1"
                                              Content="{TemplateBinding Content}"
                                              ContentTemplate="{TemplateBinding ContentTemplate}"
                                              Margin="8,0,0,0"/>
                        </Grid>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- ====================================
    Card/Panel Styles
    ==================================== -->

    <Style x:Key="CardBorderStyle" TargetType="Border">
        <Setter Property="Background" Value="{ThemeResource BackgroundPrimaryBrush}"/>
        <Setter Property="BorderBrush" Value="{ThemeResource BorderSecondaryBrush}"/>
        <Setter Property="BorderThickness" Value="{StaticResource BorderThicknessNormal}"/>
        <Setter Property="CornerRadius" Value="{StaticResource CornerRadiusLarge}"/>
        <Setter Property="Padding" Value="{StaticResource SpacingXLarge}"/>
        <Setter Property="Shadow">
            <Setter.Value>
                <ThemeShadow/>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="SectionBorderStyle" TargetType="Border">
        <Setter Property="Background" Value="{ThemeResource BackgroundSecondaryBrush}"/>
        <Setter Property="BorderBrush" Value="{ThemeResource BorderLightBrush}"/>
        <Setter Property="BorderThickness" Value="{StaticResource BorderThicknessNormal}"/>
        <Setter Property="CornerRadius" Value="{StaticResource CornerRadiusMedium}"/>
        <Setter Property="Padding" Value="{StaticResource SpacingMedium}"/>
        <Setter Property="Margin" Value="0,0,0,12"/>
    </Style>

    <!-- ====================================
    ComboBox Style
    ==================================== -->

    <Style x:Key="StandardComboBoxStyle" TargetType="ComboBox">
        <Setter Property="FontSize" Value="{StaticResource FontSizeNormal}"/>
        <Setter Property="Padding" Value="{StaticResource SpacingMedium}"/>
        <Setter Property="BorderBrush" Value="{ThemeResource BorderPrimaryBrush}"/>
        <Setter Property="Background" Value="{ThemeResource BackgroundPrimaryBrush}"/>
        <Setter Property="MinHeight" Value="40"/>
        <Setter Property="CornerRadius" Value="{StaticResource CornerRadiusMedium}"/>
    </Style>

    <!-- ====================================
    ProgressRing Style
    ==================================== -->

    <Style x:Key="LoadingProgressRingStyle" TargetType="ProgressRing">
        <Setter Property="Width" Value="48"/>
        <Setter Property="Height" Value="48"/>
        <Setter Property="Foreground" Value="{ThemeResource PrimaryDarkBrush}"/>
    </Style>

    <!-- ====================================
    Alert Severity Styles
    ==================================== -->

    <Style x:Key="AlertLowStyle" TargetType="Border">
        <Setter Property="Background" Value="{ThemeResource SeverityLowLightBrush}"/>
        <Setter Property="BorderBrush" Value="{ThemeResource SeverityLowBrush}"/>
        <Setter Property="BorderThickness" Value="2,0,0,0"/>
        <Setter Property="Padding" Value="12"/>
        <Setter Property="CornerRadius" Value="{StaticResource CornerRadiusSmall}"/>
    </Style>

    <Style x:Key="AlertMediumStyle" TargetType="Border" BasedOn="{StaticResource AlertLowStyle}">
        <Setter Property="Background" Value="{ThemeResource SeverityMediumLightBrush}"/>
        <Setter Property="BorderBrush" Value="{ThemeResource SeverityMediumBrush}"/>
    </Style>

    <Style x:Key="AlertHighStyle" TargetType="Border" BasedOn="{StaticResource AlertLowStyle}">
        <Setter Property="Background" Value="{ThemeResource SeverityHighLightBrush}"/>
        <Setter Property="BorderBrush" Value="{ThemeResource SeverityHighBrush}"/>
    </Style>

    <Style x:Key="AlertCriticalStyle" TargetType="Border" BasedOn="{StaticResource AlertLowStyle}">
        <Setter Property="Background" Value="{ThemeResource SeverityCriticalLightBrush}"/>
        <Setter Property="BorderBrush" Value="{ThemeResource SeverityCriticalBrush}"/>
    </Style>

    <!-- ====================================
    Status Badge Button Style
    ==================================== -->

    <Style x:Key="StatusBadgeButtonStyle" TargetType="Button">
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="CornerRadius" Value="6"/>
        <Setter Property="Padding" Value="12,8"/>
        <Setter Property="MinWidth" Value="120"/>
        <Setter Property="HorizontalAlignment" Value="Center"/>
        <Setter Property="VerticalAlignment" Value="Center"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Grid>
                        <Border x:Name="RootBorder"
                                Background="{TemplateBinding Background}"
                                BorderBrush="Transparent"
                                BorderThickness="1"
                                CornerRadius="{TemplateBinding CornerRadius}"
                                Padding="{TemplateBinding Padding}">
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="CommonStates">
                                    <VisualState x:Name="Normal">
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="RootBorder"
                                                             Storyboard.TargetProperty="Opacity"
                                                             To="1.0"
                                                             Duration="0:0:0.1"/>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="RootBorder"
                                                                           Storyboard.TargetProperty="BorderBrush">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="Transparent"/>
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="PointerOver">
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="RootBorder"
                                                             Storyboard.TargetProperty="Opacity"
                                                             To="0.85"
                                                             Duration="0:0:0.1"/>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="RootBorder"
                                                                           Storyboard.TargetProperty="BorderBrush">
                                                <DiscreteObjectKeyFrame KeyTime="0">
                                                    <DiscreteObjectKeyFrame.Value>
                                                        <SolidColorBrush Color="White" Opacity="0.5"/>
                                                    </DiscreteObjectKeyFrame.Value>
                                                </DiscreteObjectKeyFrame>
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Pressed">
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="RootBorder"
                                                             Storyboard.TargetProperty="Opacity"
                                                             To="0.7"
                                                             Duration="0:0:0.05"/>
                                            <DoubleAnimation Storyboard.TargetName="ContentScale"
                                                             Storyboard.TargetProperty="ScaleX"
                                                             To="0.97"
                                                             Duration="0:0:0.05"/>
                                            <DoubleAnimation Storyboard.TargetName="ContentScale"
                                                             Storyboard.TargetProperty="ScaleY"
                                                             To="0.97"
                                                             Duration="0:0:0.05"/>
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                            <Grid>
                                <Grid.RenderTransform>
                                    <ScaleTransform x:Name="ContentScale" ScaleX="1" ScaleY="1" CenterX="60" CenterY="20"/>
                                </Grid.RenderTransform>
                                <ContentPresenter
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Content="{TemplateBinding Content}"
                                    ContentTemplate="{TemplateBinding ContentTemplate}"/>
                            </Grid>
                        </Border>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- ====================================
    Status ComboBox Style - WinUI with Proper Hover Handling
    ==================================== -->

    <Style x:Key="ComboBoxStyle" TargetType="ComboBox">
        <Setter Property="Padding" Value="12,8"/>
        <Setter Property="MinWidth" Value="140"/>
        <Setter Property="MinHeight" Value="36"/>
        <Setter Property="VerticalAlignment" Value="Center"/>
        <Setter Property="HorizontalAlignment" Value="Stretch"/>
        <Setter Property="FontSize" Value="13"/>
        <Setter Property="FontWeight" Value="SemiBold"/>
        <Setter Property="Foreground" Value="White"/>
        <Setter Property="Background" Value="{StaticResource PrimaryDarkBrush}"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="CornerRadius" Value="6"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ComboBox">
                    <Grid>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="PointerOver">
                                    <VisualState.Setters>
                                        <Setter Target="Background.Opacity" Value="0.9"/>
                                        <Setter Target="DropDownGlyph.Opacity" Value="1.0"/>
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Pressed">
                                    <VisualState.Setters>
                                        <Setter Target="Background.Opacity" Value="0.8"/>
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Disabled">
                                    <VisualState.Setters>
                                        <Setter Target="Background.Opacity" Value="0.5"/>
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- Background Border -->
                        <Border x:Name="Background"
                                Grid.ColumnSpan="2"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="{TemplateBinding CornerRadius}"/>

                        <!-- Content Presenter -->
                        <ContentPresenter x:Name="ContentPresenter"
                                          Grid.Column="0"
                                          Content="{TemplateBinding SelectionBoxItem}"
                                          ContentTemplate="{TemplateBinding ItemTemplate}"
                                          Foreground="{TemplateBinding Foreground}"
                                          HorizontalAlignment="Left"
                                          VerticalAlignment="Center"
                                          Margin="{TemplateBinding Padding}"/>

                        <!-- Dropdown Arrow -->
                        <FontIcon x:Name="DropDownGlyph"
                                  Grid.Column="1"
                                  Glyph="&#xE70D;"
                                  FontSize="12"
                                  Foreground="White"
                                  Opacity="0.8"
                                  Margin="4,0,12,0"
                                  VerticalAlignment="Center"
                                  IsHitTestVisible="False"/>

                        <!-- Popup -->
                        <Popup x:Name="Popup">
                            <Border Background="{StaticResource BackgroundPrimaryBrush}"
                                    BorderBrush="{StaticResource BorderLightBrush}"
                                    BorderThickness="1"
                                    CornerRadius="8"
                                    Padding="4"
                                    MaxHeight="300">
                                <ScrollViewer VerticalScrollBarVisibility="Auto"
                                              HorizontalScrollBarVisibility="Disabled">
                                    <ItemsPresenter/>
                                </ScrollViewer>
                            </Border>
                        </Popup>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="ItemContainerStyle">
            <Setter.Value>
                <Style TargetType="ComboBoxItem">
                    <Setter Property="Padding" Value="12,10"/>
                    <Setter Property="Margin" Value="4,2"/>
                    <Setter Property="MinHeight" Value="36"/>
                    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                    <Setter Property="Background" Value="Transparent"/>
                    <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                    <Setter Property="CornerRadius" Value="4"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="ComboBoxItem">
                                <Border x:Name="ItemBorder"
                                        Background="{TemplateBinding Background}"
                                        Padding="{TemplateBinding Padding}"
                                        Margin="{TemplateBinding Margin}"
                                        CornerRadius="{TemplateBinding CornerRadius}">
                                    <VisualStateManager.VisualStateGroups>
                                        <VisualStateGroup x:Name="CommonStates">
                                            <VisualState x:Name="Normal"/>
                                            <VisualState x:Name="PointerOver">
                                                <VisualState.Setters>
                                                    <Setter Target="ItemBorder.Background" Value="{StaticResource BackgroundSecondaryBrush}"/>
                                                </VisualState.Setters>
                                            </VisualState>
                                            <VisualState x:Name="Pressed">
                                                <VisualState.Setters>
                                                    <Setter Target="ItemBorder.Background" Value="{StaticResource PrimaryLightBrush}"/>
                                                </VisualState.Setters>
                                            </VisualState>
                                            <VisualState x:Name="Selected">
                                                <VisualState.Setters>
                                                    <Setter Target="ItemBorder.Background" Value="{StaticResource PrimaryLightBrush}"/>
                                                </VisualState.Setters>
                                            </VisualState>
                                        </VisualStateGroup>
                                    </VisualStateManager.VisualStateGroups>
                                    <ContentPresenter Content="{TemplateBinding Content}"
                                                      ContentTemplate="{TemplateBinding ContentTemplate}"
                                                      HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"/>
                                </Border>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- ====================================
    MenuFlyout Styles
    ==================================== -->

    <!-- Device Card Menu Button Style -->
    <Style x:Key="DeviceMenuButtonStyle" TargetType="Button">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Width" Value="32"/>
        <Setter Property="Height" Value="32"/>
        <Setter Property="Padding" Value="0"/>
        <Setter Property="VerticalAlignment" Value="Center"/>
        <Setter Property="CornerRadius" Value="6"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border x:Name="RootBorder"
                            Background="{TemplateBinding Background}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="{TemplateBinding CornerRadius}"
                            Padding="{TemplateBinding Padding}">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="PointerOver">
                                    <VisualState.Setters>
                                        <Setter Target="RootBorder.Background" Value="{StaticResource BackgroundSecondaryBrush}"/>
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Pressed">
                                    <VisualState.Setters>
                                        <Setter Target="RootBorder.Background" Value="{StaticResource BackgroundAccentBrush}"/>
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- MenuFlyout Presenter Style - Theme-aware style -->
    <Style TargetType="MenuFlyoutPresenter">
        <Setter Property="Background" Value="{ThemeResource BackgroundPrimaryBrush}"/>
        <Setter Property="BorderBrush" Value="{ThemeResource BorderLightBrush}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Padding" Value="4"/>
        <Setter Property="CornerRadius" Value="8"/>
        <Setter Property="MinWidth" Value="200"/>
    </Style>

    <Style x:Key="DeviceMenuFlyoutPresenterStyle" TargetType="MenuFlyoutPresenter">
        <Setter Property="Background" Value="{ThemeResource BackgroundPrimaryBrush}"/>
        <Setter Property="BorderBrush" Value="{ThemeResource BorderLightBrush}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Padding" Value="4"/>
        <Setter Property="CornerRadius" Value="8"/>
        <Setter Property="MinWidth" Value="200"/>
    </Style>

    <!-- MenuFlyoutItem Style - Override default -->
    <Style TargetType="MenuFlyoutItem">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Padding" Value="12,10"/>
        <Setter Property="FontSize" Value="14"/>
        <Setter Property="Foreground" Value="{ThemeResource TextPrimaryBrush}"/>
        <Setter Property="CornerRadius" Value="4"/>
        <Setter Property="Margin" Value="2"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="MenuFlyoutItem">
                    <Border x:Name="LayoutRoot"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="{TemplateBinding CornerRadius}"
                            Padding="{TemplateBinding Padding}">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="PointerOver">
                                    <VisualState.Setters>
                                        <Setter Target="LayoutRoot.Background" Value="{ThemeResource BackgroundSecondaryBrush}"/>
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Pressed">
                                    <VisualState.Setters>
                                        <Setter Target="LayoutRoot.Background" Value="{ThemeResource PrimaryLightBrush}"/>
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Disabled">
                                    <VisualState.Setters>
                                        <Setter Target="LayoutRoot.Opacity" Value="0.5"/>
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <ContentPresenter x:Name="IconContent"
                                              Grid.Column="0"
                                              Content="{TemplateBinding Icon}"
                                              Margin="0,0,12,0"
                                              VerticalAlignment="Center"/>
                            <TextBlock x:Name="TextBlock"
                                       Grid.Column="1"
                                       Text="{TemplateBinding Text}"
                                       Foreground="{TemplateBinding Foreground}"
                                       VerticalAlignment="Center"/>
                            <TextBlock x:Name="KeyboardAcceleratorTextBlock"
                                       Grid.Column="2"
                                       Text="{TemplateBinding KeyboardAcceleratorTextOverride}"
                                       Foreground="{ThemeResource TextTertiaryBrush}"
                                       FontSize="12"
                                       Margin="24,0,0,0"
                                       VerticalAlignment="Center"/>
                        </Grid>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="MenuFlyoutSeparator">
        <Setter Property="Background" Value="{ThemeResource BorderLightBrush}"/>
        <Setter Property="Height" Value="1"/>
        <Setter Property="Margin" Value="8,4"/>
    </Style>

    <!-- ====================================
    ContentDialog Styles
    ==================================== -->

    <Style x:Key="DefaultContentDialogStyle" TargetType="ContentDialog">
        <Setter Property="Foreground" Value="{ThemeResource TextPrimaryBrush}"/>
        <Setter Property="Background" Value="{ThemeResource BackgroundPrimaryBrush}"/>
        <Setter Property="BorderBrush" Value="{ThemeResource BorderLightBrush}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="CornerRadius" Value="8"/>
        <Setter Property="TitleTemplate">
            <Setter.Value>
                <DataTemplate>
                    <TextBlock Text="{Binding}"
                               FontSize="20"
                               FontWeight="SemiBold"
                               Foreground="{ThemeResource PrimaryDarkBrush}"
                               Margin="0,0,0,8"/>
                </DataTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</ResourceDictionary>